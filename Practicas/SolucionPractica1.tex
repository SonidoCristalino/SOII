\documentclass[10pt, spanish]{article}

\usepackage{geometry} %Necesario para poder equiparar los márgenes
 \geometry{
    a4paper,
    total={170mm,257mm},
    left=20mm,
     top=20mm,
}
\usepackage[spanish]{babel}
\usepackage[latin1]{inputenc}

\usepackage{listings}
\usepackage{color}

\lstloadlanguages{C,C++,csh,Java}

\definecolor{red}{rgb}{0.6,0,0}
\definecolor{blue}{rgb}{0,0,0.6}
\definecolor{green}{rgb}{0,0.8,0}
\definecolor{cyan}{rgb}{0.0,0.6,0.6}
\definecolor{cloudwhite}{rgb}{0.9412, 0.9608, 0.8471}

\lstset{
    language=csh,
    basicstyle=\footnotesize\ttfamily,
    numbers=left,
    numberstyle=\tiny,
    numbersep=5pt,
    tabsize=2,
    extendedchars=true,
    breaklines=true,
    frame=b,
    stringstyle=\color{blue}\ttfamily,
    showspaces=false,
    showtabs=false,
    xleftmargin=17pt,
    framexleftmargin=17pt,
    framexrightmargin=5pt,
    framexbottommargin=4pt,
    commentstyle=\color{green},
    morecomment=[l]{//}, %use comment-line-style!
    morecomment=[s]{/*}{*/}, %for multiline comments
    showstringspaces=false,
    morekeywords={ abstract, event, new, struct,
    as, explicit, null, switch,
    base, extern, object, this,
    bool, false, operator, throw,
    break, finally, out, true,
    byte, fixed, override, try,
    case, float, params, typeof,
    catch, for, private, uint,
    char, foreach, protected, ulong,
    checked, goto, public, unchecked,
    class, if, readonly, unsafe,
    const, implicit, ref, ushort,
    continue, in, return, using,
    decimal, int, sbyte, virtual,
    default, interface, sealed, volatile,
    delegate, internal, short, void,
    do, is, sizeof, while,
    double, lock, stackalloc,
    else, long, static,
    enum, namespace, string},
    keywordstyle=\color{cyan},
    identifierstyle=\color{red},
    backgroundcolor=\color{cloudwhite},
}

\usepackage{caption}
\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{\colorbox{blue}{\parbox{\textwidth}{\hspace{15pt}#1#2#3}}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white, singlelinecheck=false, margin=0pt, font={bf,footnotesize}}

\author{Emiliano Salvatori}
\title{Sistemas Operativos II\\
    \large Practica I}
\date{Septiembre 2019}
\pagestyle{headings}

\begin{document}
\maketitle


% ----------------------------------------------------------------------
%                       INTRODUCION
% ----------------------------------------------------------------------
\section{Practica 1}

\subsection*{Interbloqueo}

\subsubsection*{Analice si el siguiente código puede sufrir un potencial interbloqueo suponiendo que se ejecutan en un
sistema multiprocesador}

Es posible que exista un interbloqueo ya que no se están utilizando las llamadas al sistema que permiten bloquear la
utilización del recurso. Estas dos funciones son: \emph{wait()} y \emph{signal}

\lstinputlisting[language={C}]{practica1_1.c}

\subsubsection*{Indique cómo se puede evitar el potencial interbloqueo}

Se puede evitar de la siguiente manera:

\lstinputlisting[language={C}]{practica1_2.c}

\subsubsection*{Indique por qué el siguiente grafo de asignación de recursos tiene un interbloqueo}

Se puede observar que existe una situación de interbloqueo debido a que se dan las 4 condiciones para ello, a saber:
\begin{itemize}
    \item
        \textbf{Exlusión Mutua}: Es decir que hay \emph{recursos no compartidos} de uso exlusivo para cada proceso. El
        proceso toma para sí un recurso o una instancia de ese recurso.
    \item
        \textbf{Contención y espera}: Un proceso toma para sí un recurso o una instancia de ese recurso y solicita y
        espera otro recurso que solicitó.
    \item
        \textbf{Condición no apropiativa}: No se le puede expropiar un recurso otorgado a un proceso, sino que debe
        liberarlo por sí solo, no pueden ser quitados por la fuerza.
    \item
        \textbf{Espera circular}: Efectivamente se puede observar en el grafo que se hayan los procesos en una espera
        circular entre ellos y los recursos solicitados/obtenidos. Cada uno de los procesos espera el siguiente recurso
        que a su vez está asignado a otro proceso. Esto genera que haya una interdependencia.
\end{itemize}

En el grafico se puede observar que existe un ciclo donde cada proceso tiene asignado un determinado recurso que a su
vez está siendo solicitado por otro proceso. De esta forma, como el recurso no puede serle expropiado a los procesos de
una forma deliberada, sólo podrá liberarlo cuando el proceso haya terminado de utilizarlo. El problema que se da es que
se espera una situación que nunca se dará, ya que ninguno de los procesos podrá liberar el recurso obtenido ni tampoco
podrá obtener el siguiente recurso para terminar su tarea.

\subsubsection*{Implemente el algoritmo de detección de Deadlock teniendo en cuenta que se tienen 3 procesos y 4 tipos
diferentes de recursos (Unidades de CD-ROM, Escaneres, Impresoras y lectoras SD). En este contexto el proceso 1 tiene un
escáner, el proceso 2 tiene dos lectoras SD y una unidad de CD-ROM y el proceso 3 tiene una impresora y dos escáneres}

% Para la creación de tablas se visitó: https://www.overleaf.com/learn/latex/Tables#Creating_a_simple_table_in_LaTeX

Tabla de Requerimientos por proceso:
\begin{center}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
            -       & SD & Impresora & Escáner & Cd-Rom \\
        \hline
            P1      & 2  & 0 & 0 & 1 \\
        \hline
            P2      & 1  & 0 & 3 & 0 \\
        \hline
            P3      & 2  & 1 & 0 & 0 \\
        \hline
    \end{tabular}
\end{center}

Tabla de recursos disponibles:
\begin{center}
    \begin{tabular}{|c|c|c|c|}
        \hline
            SD & Impresora & Escáner & Cd-Rom \\
        \hline
            4  & 2 & 3 & 1 \\
        \hline
    \end{tabular}
\end{center}

Para ello lo que se realiza es una tabla de asignación, donde se deja asentado cómo se asignan los recursos siguiendo el
\emph{método del banquero}:

Asignación en \textbf{Iteración nº 1}:
\begin{center}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
            -       & SD & Impresora & Escáner & Cd-Rom \\
        \hline
            P1      & 2  & 0 & 0 & 1 \\
        \hline
            P2      & 1  & 0 & 3 & 0 \\
        \hline
    \end{tabular}
\end{center}

Requerimientos en \textbf{Iteración nº 1}:
\begin{center}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
            -       & SD & Impresora & Escáner & Cd-Rom \\
        \hline
            P1      & 0  & 0 & 0 & 0 \\
        \hline
            P2      & 0  & 0 & 0 & 0 \\
        \hline
            P3      & 2  & 1 & 0 & 0 \\
        \hline
    \end{tabular}
\end{center}

Recursos disponibles en \textbf{Iteración nº 1}:
\begin{center}
    \begin{tabular}{|c|c|c|c|}
        \hline
            SD & Impresora & Escáner & Cd-Rom \\
        \hline
            1  & 2 & 0 & 0 \\
        \hline
    \end{tabular}
\end{center}

Luego de esta primera iteración el proceso nº 1 y el nº 2 terminan, quedando la tabla de Recursos disponibles de la
siguiente manera:

Recursos disponibles:
\begin{center}
    \begin{tabular}{|c|c|c|c|}
        \hline
            SD & Impresora & Escáner & Cd-Rom \\
        \hline
            4  & 2 & 3 & 1 \\
        \hline
    \end{tabular}
\end{center}

Ahora es posible brindarle los recursos al proceso que falta:

Asignación en \textbf{Iteración nº 2}:
\begin{center}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
            -       & SD & Impresora & Escáner & Cd-Rom \\
        \hline
            P3      & 2  & 1 & 0 & 0 \\
        \hline
    \end{tabular}
\end{center}


Requerimientos en \textbf{Iteración nº 2}:
\begin{center}
    \begin{tabular}{|c|c|c|c|c|}
        \hline
            -       & SD & Impresora & Escáner & Cd-Rom \\
        \hline
            P1      & 0  & 0 & 0 & 0 \\
        \hline
            P2      & 0  & 0 & 0 & 0 \\
        \hline
            P3      & 0  & 0 & 0 & 0 \\
        \hline
    \end{tabular}
\end{center}

Recursos disponibles en \textbf{Iteración nº 2}:
\begin{center}
    \begin{tabular}{|c|c|c|c|}
        \hline
            SD & Impresora & Escáner & Cd-Rom \\
        \hline
            2  & 1 & 3 & 1 \\
        \hline
    \end{tabular}
\end{center}

Una vez finalizado este segundo ciclo, el proceso nº 3 finaliza por lo que se obtiene la siguiente tabla de Recursos
Disponibles:

Tabla de recursos disponibles luego de la \textbf{Iteración nº 2}:
\begin{center}
    \begin{tabular}{|c|c|c|c|}
        \hline
            SD & Impresora & Escáner & Cd-Rom \\
        \hline
            4  & 2 & 3 & 1 \\
        \hline
    \end{tabular}
\end{center}

\subsubsection*{Indique por qué el siguiente grafo de asignación de recursos tiene un interbloqueo}

\end{document}

